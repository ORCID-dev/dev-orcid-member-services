<div *ngIf="memberData" class="h-100">
  <div class="p-3 mb-3">
    <div class="go-back">
      Back to <a routerLink="">{{ memberData.publicDisplayName }}</a>
    </div>
    <hr class="mb-4" />
    <div class="edit-org-label mb-3">Edit organization</div>
    <h1 class="font-weight-bold mb-3 wide-text">{{ memberData.publicDisplayName }}</h1>
    <div>Manage how this organization is displayed on the <a href="{{ MEMBER_LIST_URL }}">ORCID member list</a>.</div>
  </div>
  <div class="d-flex">
    <div class="side-bar">
      <div class="logo-container">
        <img src="{{ memberData.logoUrl }}" onerror="this.src='../../content/images/member-logo-placeholder.svg'" alt="Member logo" />
      </div>
      <div class="text-center">
        <img src="./../../../../content/images/lockpad.svg" alt="Locked" />
      </div>
      <div class="text-center m-1">
        <em class="wide-text small-text">Logo upload coming soon</em>
      </div>
    </div>
    <div class="main-section">
      <form (ngSubmit)="save()" name="editForm" role="form" [formGroup]="editForm">
        <h3 class="mb-3 wide-text">Public details</h3>
        <div class="form mb-5">
          <div class="form-group w-50">
            <label class="wide-text small-text">Organization name</label>
            <input type="text" class="form-control" name="name" formControlName="name" />
            <div *ngIf="editForm.get('name').invalid && (editForm.get('name').dirty || editForm.get('name').touched)">
              <small class="wide-text small-text form-text text-danger" *ngIf="editForm.get('name').errors.required">
                The organization name cannot be empty
              </small>
            </div>
          </div>
          <div class="form-group">
            <label class="wide-text small-text">Organization description</label>
            <textarea
              type="text"
              class="form-control w-75"
              name="description"
              formControlName="description"
              cdkTextareaAutosize
              cdkAutosizeMinRows="1"
              cdkAutosizeMaxRows="5"
              placeholder="A brief description of the organization"
            ></textarea>
          </div>
          <div class="form-group w-50">
            <label class="wide-text small-text">Website</label>
            <input type="text" class="form-control" name="website" formControlName="website" />
            <ng-template #validWebsite>
              <small class="wide-text small-text input-prompt">Links should be in the full URL format e.g. http://www.website.com</small>
            </ng-template>
            <div *ngIf="editForm.get('website').invalid && (editForm.get('website').dirty || editForm.get('website').touched); else validWebsite">
              <small class="wide-text small-text text-danger" *ngIf="editForm.get('website').errors.pattern">
                Please enter a valid website URL, for example http://www.website.com
              </small>
            </div>
          </div>
          <div class="form-group mb-4 w-50">
            <label class="wide-text small-text">Email</label>
            <input type="text" class="form-control" name="email" formControlName="email" />
            <ng-template  #validEmail>
              <small class="wide-text small-text input-prompt">Emails should be in the standard format e.g. contactus@website.com</small>
            </ng-template>
            <div *ngIf="editForm.get('email').invalid && (editForm.get('email').dirty || editForm.get('email').touched); else validEmail">
              <small class="wide-text small-text text-danger" *ngIf="editForm.get('email').errors.pattern">
                Please enter a valid email address, for example contactus@website.com
              </small>
            </div>
          </div>
          <button type="submit" [disabled]="editForm.invalid || isSaving" class="btn btn-primary">Save changes</button>
          <button type="button" class="btn btn-outline-primary" routerLink="">Cancel</button>
        </div>
      </form>
      <div *ngIf="memberData.orgIds" class="identifiers">
        <div class="d-flex mb-2">
          <h3 class="mb-0 mr-2">Identifiers</h3>
          <img class="lockpad" src="./../../../../content/images/lockpad.svg" alt="Locked" />
        </div>
        <div class="wide-text small-text coming-soon">
          <em>Editable identifiers coming soon</em>
        </div>
        <div class="row ml-0 d-flex justify-content-between contact">
          <h6 class="w-66">ID</h6>
          <h6 class="w-33">Type</h6>
        </div>
        <hr class="green-hr" />
        <ul class="ml-0 pl-0" *ngFor="let orgIdType of objectKeys(memberData.orgIds); let i = index">
          <div *ngFor="let orgId of memberData.orgIds[orgIdType]; let ii = index">
            <li class="row ml-0 d-flex justify-content-between contact">
              <div class="w-66">{{ orgId }}</div>
              <div class="w-33">{{ orgIdType }}</div>
            </li>
            <hr *ngIf="!(i == objectKeys(memberData.orgIds).length - 1 && ii == memberData.orgIds[orgIdType].length - 1)" />
          </div>
        </ul>
      </div>
      <div *ngIf="memberData.contacts">
        <div class="d-flex mb-2">
          <h3 class="mb-0 mr-2">Contacts</h3>
          <img class="lockpad" src="./../../../../content/images/lockpad.svg" alt="Locked" />
        </div>
        <div class="wide-text small-text coming-soon">
          <em>Editable contacts coming soon</em>
        </div>
        <div class="row ml-0 d-flex justify-content-between contact">
          <h6>Name</h6>
          <h6>Roles</h6>
          <h6>Email</h6>
          <h6 class="voting-contact">Voting</h6>
        </div>
        <hr class="green-hr" />
        <ul class="ml-0 pl-0" *ngFor="let contact of memberData.contacts; let i = index">
          <li class="row ml-0 d-flex justify-content-between contact">
            <div>{{ contact.name }}</div>
            <div>{{ contact.memberOrgRole }}</div>
            <div>
              <a href="mailto:{{ contact.contactEmail }}">{{ contact.contactEmail }}</a>
            </div>
            <div class="voting-contact">
              <img *ngIf="contact.votingContact" src="./../../../../content/images/checkmark.svg" alt="Yes" />
            </div>
          </li>
          <hr *ngIf="i + 1 < memberData.contacts.length" />
        </ul>
      </div>
      <div *ngIf="memberData.isConsortiumLead">
        <h5 class="mb-4">
          Consortium Members
          <span class="font-weight-normal">({{ memberData.consortiumMembers.length }})</span>
        </h5>
        <h6>Member name</h6>
        <hr class="green-hr" />
        <div *ngFor="let consortiumMember of memberData.consortiumMembers; let i = index">
          <div>{{ consortiumMember.name }}</div>
          <hr *ngIf="i + 1 < memberData.consortiumMembers.length" />
        </div>
      </div>
    </div>
  </div>
</div>
